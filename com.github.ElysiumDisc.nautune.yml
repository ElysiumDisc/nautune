# Generated by flatpak-flutter v0.12.0 from flatpak-flutter.yml, do not edit
# Visit the project at https://github.com/TheAppgineer/flatpak-flutter
id: com.github.ElysiumDisc.nautune
runtime: org.freedesktop.Platform
runtime-version: '24.08'
sdk: org.freedesktop.Sdk
command: nautune
finish-args:
  - --share=network
  - --share=ipc
  - --socket=pulseaudio
  - --device=dri
  - --socket=wayland
  - --socket=fallback-x11
  - --talk-name=org.kde.StatusNotifierWatcher
  - --talk-name=org.freedesktop.Notifications
  - --own-name=org.mpris.MediaPlayer2.nautune
modules:
  - name: nautune
    buildsystem: simple
    build-options:
      arch:
        x86_64:
          env:
            BUNDLE_PATH: build/linux/x64/release/bundle
        aarch64:
          env:
            BUNDLE_PATH: build/linux/arm64/release/bundle
      append-path: /var/lib/flutter/bin
      env:
        PUB_CACHE: /run/build/nautune/.pub-cache
    build-commands:
      - setup-flutter.sh
      - flutter build linux --release --no-pub
      - install -D $BUNDLE_PATH/nautune /app/bin/nautune
      - cp -r $BUNDLE_PATH/lib /app/bin/lib
      - cp -r $BUNDLE_PATH/data /app/bin/data
      - install -Dm644 com.github.ElysiumDisc.nautune.desktop /app/share/applications/com.github.ElysiumDisc.nautune.desktop
      - install -Dm644 com.github.ElysiumDisc.nautune.metainfo.xml /app/share/metainfo/com.github.ElysiumDisc.nautune.metainfo.xml
      - "python3 -c \"\nimport gi\ngi.require_version('GdkPixbuf', '2.0')\nfrom gi.repository\
        \ import GdkPixbuf\nimport os\nfor size in [512, 256, 128]:\n    d = f'/app/share/icons/hicolor/{size}x{size}/apps'\n\
        \    os.makedirs(d, exist_ok=True)\n    pb = GdkPixbuf.Pixbuf.new_from_file_at_scale('assets/icon.png',\
        \ size, size, True)\n    pb.savev(f'{d}/com.github.ElysiumDisc.nautune.png',\
        \ 'png', [], [])\n\"\n"
    sources:
      - type: git
        url: https://github.com/ElysiumDisc/nautune.git
        commit: db810545a082af3341c1b18358ca26f12651d8c3
      - generated/sources/pubspec.json
    modules:
      - generated/modules/flutter-sdk-3.38.9.json
